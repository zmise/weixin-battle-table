!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Coala=e():t.Coala=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i=n(1),r=n(3),o=n(5),s={observable:r,mount:function(t,e){return this.component(t).mount(e)},component:function(t){return new i(t)},router:function(t){return new o(t).start()}};r(s),t.exports=s},function(t,e,n){function i(t){if(this.opts=t||{},this.listen=this.opts.listen||{},this.handle=this.opts.handle||{},this.refs={},o(this),this._mixin(),this._listenTo(),$.isFunction(t.data)){var e=t.data.call(this);e&&e.promise?(this.promise=e,this.data=this.data||{}):this.data=e}else this.data=$.extend(!0,$.isArray(t.data)?[]:{},t.data);this._initRefs(),this.trigger("init")}var r=n(2),o=n(3),s=n(4);i.prototype={_initRefs:function(){if(this.opts.refs)for(var t in this.opts.refs){var e=this.opts.refs[t],n=new i(e.component);e.data&&(n.data=$.extend($.isArray(e.data)?[]:{},e.component.data,e.data)),n.refOpts=e,n.parent=this,this.refs[t]=n}},_bindEvents:function(){if(this.opts.events)for(var t in this.opts.events){var e=this.opts.events[t],n=t.indexOf(" ");if(-1===n)throw"The "+e+" event is not separated by whitespace.";if(!this.handle[e])throw"The "+e+" handle is not defined.";var i=t.substr(n+1,t.length);this.el.on(t.substr(0,n),i,$.proxy(this.handle[e],this))}},_mixin:function(){this.opts.mixins&&($.isArray(this.opts.mixins)||(this.opts.mixins=[this.opts.mixins]),$.extend.apply($,[!0,this].concat(this.opts.mixins)))},_listenTo:function(){for(var t in this.listen){var e=this.listen[t];this.on(t,e)}},mount:function(t){var e=this;return this.promise?this.promise.done(function(n){e.data.resource=n,e._mount(t),delete e.promise}):this._mount(t),this},_mount:function(t){if(this.trigger("update"),t&&(this.parent?(this.es=this.parent.es+" "+t,this.el=this.parent.$(t)):(this.es=t,this.el=$(t))),this.opts.tpl){var e=this.el.clone();e.html(this.opts.tpl(this.data)),s(e,this.es),this.el.append(e.html()),this._bindEvents();for(var n in this.refs){var i=this.refs[n];i&&i.mount(i.refOpts.el)}}return this.trigger("updated").trigger("mount"),this},update:function(t){return t&&$.extend(this.data,t),r(this.el[0],this._update()[0],{onBeforeElUpdated:function(t){return"STYLE"!==t.tagName}}),this._updated(),this},_update:function(){if(this.trigger("update"),!this.opts.tpl)return"";var t=this.el.clone();t.html(this.opts.tpl(this.data));for(var e in this.refs){var n=this.refs[e];t.find(n.refOpts.el).html(n._update().html())}return t},_updated:function(){for(var t in this.refs)this.refs[t]._updated();this.trigger("updated")},unmount:function(){this.promise&&this.promise.abort(),this._unmount(),this.el&&this.el.empty().off()},_unmount:function(){for(var t in this.refs)this.refs[t]._unmount();this.trigger("unmount").off("*")},$:function(t){return this.el.find(t)}},t.exports=i},function(t,e){"use strict";function n(t){!f&&l.createRange&&(f=l.createRange()).selectNode(l.body);var e;return f&&f.createContextualFragment?e=f.createContextualFragment(t):(e=l.createElement("body")).innerHTML=t,e.childNodes[0]}function i(t,e){var n=t.nodeName,i=e.nodeName;return n===i||!!(e.actualize&&n.charCodeAt(0)<91&&i.charCodeAt(0)>90)&&n===i.toUpperCase()}function r(t,e){return e&&e!==h?l.createElementNS(e,t):l.createElement(t)}function o(t,e){for(var n=t.firstChild;n;){var i=n.nextSibling;e.appendChild(n),n=i}return e}function s(t,e,n){t[n]!==e[n]&&(t[n]=e[n],t[n]?t.setAttribute(n,""):t.removeAttribute(n,""))}function a(){}function u(t){return t.id}var f,d,h="http://www.w3.org/1999/xhtml",l="undefined"==typeof document?void 0:document,c=l?l.body||l.createElement("div"):{},p=d=c.hasAttributeNS?function(t,e,n){return t.hasAttributeNS(e,n)}:c.hasAttribute?function(t,e,n){return t.hasAttribute(n)}:function(t,e,n){return null!=t.getAttributeNode(e,n)},m={OPTION:function(t,e){s(t,e,"selected")},INPUT:function(t,e){s(t,e,"checked"),s(t,e,"disabled"),t.value!==e.value&&(t.value=e.value),p(e,null,"value")||t.removeAttribute("value")},TEXTAREA:function(t,e){var n=e.value;t.value!==n&&(t.value=n);var i=t.firstChild;if(i){var r=i.nodeValue;if(r==n||!n&&r==t.placeholder)return;i.nodeValue=n}},SELECT:function(t,e){if(!p(e,null,"multiple")){for(var n=0,i=e.firstChild;i;){var r=i.nodeName;if(r&&"OPTION"===r.toUpperCase()){if(p(i,null,"selected")){n;break}n++}i=i.nextSibling}t.selectedIndex=n}}},v=1,g=3,x=8,b=function(t){return function(e,s,f){function d(t){w?w.push(t):w=[t]}function h(t,e){if(t.nodeType===v)for(var n=t.firstChild;n;){var i=void 0;e&&(i=_(n))?d(i):($(n),n.firstChild&&h(n,e)),n=n.nextSibling}}function c(t,e,n){!1!==S(t)&&(e&&e.removeChild(t),$(t),h(t,n))}function p(t){if(t.nodeType===v)for(var e=t.firstChild;e;){var n=_(e);n&&(U[n]=e),p(e),e=e.nextSibling}}function b(t){A(t);for(var e=t.firstChild;e;){var n=e.nextSibling,r=_(e);if(r){var o=U[r];o&&i(e,o)&&(e.parentNode.replaceChild(o,e),y(o,e))}b(e),e=n}}function y(n,r,o){var a,u=_(r);if(u&&delete U[u],!s.isSameNode||!s.isSameNode(e)){if(!o){if(!1===C(n,r))return;if(t(n,r),T(n),!1===R(n,r))return}if("TEXTAREA"!==n.nodeName){var f,h,p,N,w=r.firstChild,A=n.firstChild;t:for(;w;){for(p=w.nextSibling,f=_(w);A;){if(h=A.nextSibling,w.isSameNode&&w.isSameNode(A)){w=p,A=h;continue t}a=_(A);var S=A.nodeType,$=void 0;if(S===w.nodeType&&(S===v?(f?f!==a&&((N=U[f])?A.nextSibling===N?$=!1:(n.insertBefore(N,A),h=A.nextSibling,a?d(a):c(A,n,!0),A=N):$=!1):a&&($=!1),($=!1!==$&&i(A,w))&&y(A,w)):S!==g&&S!=x||($=!0,A.nodeValue!==w.nodeValue&&(A.nodeValue=w.nodeValue))),$){w=p,A=h;continue t}a?d(a):c(A,n,!0),A=h}if(f&&(N=U[f])&&i(N,w))n.appendChild(N),y(N,w);else{var L=E(w);!1!==L&&(L&&(w=L),w.actualize&&(w=w.actualize(n.ownerDocument||l)),n.appendChild(w),b(w))}w=p,A=h}for(;A;)h=A.nextSibling,(a=_(A))?d(a):c(A,n,!0),A=h}var V=m[n.nodeName];V&&V(n,r)}}if(f||(f={}),"string"==typeof s)if("#document"===e.nodeName||"HTML"===e.nodeName){var N=s;(s=l.createElement("html")).innerHTML=N}else s=n(s);var w,_=f.getNodeKey||u,E=f.onBeforeNodeAdded||a,A=f.onNodeAdded||a,C=f.onBeforeElUpdated||a,T=f.onElUpdated||a,S=f.onBeforeNodeDiscarded||a,$=f.onNodeDiscarded||a,R=f.onBeforeElChildrenUpdated||a,L=!0===f.childrenOnly,U={};p(e);var V=e,O=V.nodeType,I=s.nodeType;if(!L)if(O===v)I===v?i(e,s)||($(e),V=o(e,r(s.nodeName,s.namespaceURI))):V=s;else if(O===g||O===x){if(I===O)return V.nodeValue!==s.nodeValue&&(V.nodeValue=s.nodeValue),V;V=s}if(V===s)$(e);else if(y(V,s,L),w)for(var B=0,k=w.length;B<k;B++){var z=U[w[B]];z&&c(z,z.parentNode,!1)}return!L&&V!==e&&e.parentNode&&(V.actualize&&(V=V.actualize(e.ownerDocument||l)),e.parentNode.replaceChild(V,e)),V}}(function(t,e){var n,i,r,o,s,a=e.attributes;for(n=a.length-1;n>=0;--n)r=(i=a[n]).name,o=i.namespaceURI,s=i.value,o?(r=i.localName||r,t.getAttributeNS(o,r)!==s&&t.setAttributeNS(o,r,s)):t.getAttribute(r)!==s&&t.setAttribute(r,s);for(n=(a=t.attributes).length-1;n>=0;--n)!1!==(i=a[n]).specified&&(r=i.name,(o=i.namespaceURI)?(r=i.localName||r,p(e,o,r)||t.removeAttributeNS(o,r)):p(e,null,r)||t.removeAttribute(r))});t.exports=b},function(t,e){t.exports=function(t){var e={};return(t=t||{}).on=function(n,i){return"function"==typeof i&&(e[n]=e[n]||[]).push(i),t},t.off=function(n,i){if("*"!=n||i)if(i)for(var r,o=e[n],s=0;r=o&&o[s];++s)r==i&&o.splice(s--,1);else delete e[n];else e={};return t},t.one=function(e,n){function i(){t.off(e,i),n.apply(t,arguments)}return t.on(e,i)},t.trigger=function(n){var i,r,o,s=arguments.length-1,a=new Array(s);for(o=0;o<s;o++)a[o]=arguments[o+1];for(i=[].slice.call(e[n]||[],0),o=0;r=i[o];++o)r.apply(t,a);return e["*"]&&"*"!=n&&t.trigger.apply(t,["*",n].concat(a)),t},t}},function(t,e){function n(t,e){var n=new RegExp("([^\r\n,{}]+)(,(?=[^}]*{)|s*{)","g");return t=t.replace(n,function(t,n,i){return n.match(/^\s*(@media|@keyframes|to|from|@font-face)/)?n+i:(n.match(/:scope/)&&(n=n.replace(/([^\s]*):scope/,function(t,e){return e?" "+e:" "})),(n=n.replace(/^(\s*)/,"$1"+e+" "))+i)})}t.exports=function(t,e){if(!("scoped"in document.createElement("style"))){var i=t.find("style[scoped]");if(0!==i.length)for(var r=0;r<i.length;r++)i[r].innerHTML=n(i[r].innerHTML,e)}}},function(t,e){function n(t){i=this,this.opts=t,this.routes=t.routes,this._emit()}var i,r=[/[\-{}\[\]+?.,\\\^$|#\s]/g,/\((.*?)\)/g,/(\(\?)?:\w+/g,/\*\w+/g],o=function(t){return t=t.replace(r[0],"\\$&").replace(r[1],"(?:$1)?").replace(r[2],function(t,e){return e?t:"([^/?]+)"}).replace(r[3],"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},s=function(t,e){var n,i=t.exec(e).slice(1),r=[];for(n=0;n<i.length;n++)r.push(decodeURIComponent(i[n])||null);return r};n.prototype={_exec:function(t){for(var e in this.routes){var n=o(e);if(n.test(t))if("function"==typeof this.routes[e])this.routes[e].apply(this,s(n,t));else{var i=this.opts[this.routes[e]];i&&i.apply(this,s(n,t))}}},_emit:function(t){var e=location.href.split("#")[1]||"/";i._exec(e,t)},start:function(){return window.addEventListener?window.addEventListener("hashchange",this._emit,!1):window.attachEvent("onhashchange",this._emit),this},stop:function(){return window.removeEventListener?window.removeEventListener("hashchange",this._emit,!1):window.detachEvent("onhashchange",this._emit),this},go:function(t){return location.hash=t,this},back:function(){return history.back(),this},add:function(t,e){return this.routes[t]=e,this},remove:function(t){return delete this.routes[t],this}},t.exports=n}])});